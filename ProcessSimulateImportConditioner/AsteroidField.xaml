<UserControl x:Class="ProcessSimulateImportConditioner.AsteroidField"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d"
             xmlns:local="clr-namespace:ProcessSimulateImportConditioner"
             d:DesignHeight="300" d:DesignWidth="300">
    <ItemsControl x:Name="asteroidFieldRoot" ItemsSource="{Binding Asteroids}">
        <ItemsControl.Resources>
            <local:PointPercentageToPixelConverter x:Key="PointPercentageToPixelConverter"/>
            
            <Viewbox x:Key="Asteroid1">
                <Canvas Width="118.499" Height="118.05842">
                    <Path Stretch="Uniform" Fill="Black" Data="m 72.88 5.511 c -1.235 0.157 -3.25 0.699 -5.75 1.924 -0.049 0.024 -0.082 0.066 -0.128 0.094 -2.126 1.096 -4.175 2.334 -6.133 3.708 l -0.564 0.386 C 52.953 16.659 46.605 21.009 27.018 24.689 4.75 28.874 4.75 51.8 4.75 64.119 c 0 10.619 6.324 21 12.591 26.583 1.867 1.663 3.362 4.148 5.092 7.026 3.656 6.08 8.207 13.647 19.5 19.742 12.234 6.6 19.709 3.883 25.165 1.895 1.983 -0.721 3.7 -1.348 5.071 -1.239 2.147 0.306 4.191 1.113 5.966 2.358 2.224 1.308 4.706 2.767 8.011 2.767 0.532 -0.001 1.063 -0.037 1.59 -0.11 8.345 -1.142 10.612 -11.629 11.357 -15.075 1.377 -6.727 5.337 -12.647 11.029 -16.488 8.526 -5.92 13.127 -19.165 13.127 -28.622 0.001 -5.795 -1.561 -9.134 -3.722 -13.756 -2.253 -4.656 -4.154 -9.474 -5.689 -14.413 -3.61 -11.619 -5.795 -13.688 -8.181 -16.558 -2.171 -2.612 -4.335 -4.438 -5.483 -5.348 C 95.899 9.49 91.946 7.879 90.62 7.37 90.619 7.37 83.233 4.198 72.88 5.511 Z m 29.201 13.917 c -4.5 2.909 -10.835 3.8 -17.008 2.3 C 77.975 20 72.251 15.45 70.066 9.928 c 2.714 -0.755 9.291 -2.193 17.162 0.083 8.12 2.347 12.996 7.311 14.853 9.417 z m 6.046 69.272 c -6.428 4.339 -10.9 11.026 -12.455 18.624 -1.678 7.763 -4.428 11.8 -8.409 12.346 -2.921 0.4 -4.976 -0.809 -7.354 -2.207 -2.23 -1.524 -4.792 -2.494 -7.472 -2.83 -0.2 -0.015 -0.4 -0.023 -0.6 -0.023 -2.049 0.142 -4.058 0.637 -5.938 1.463 -5.1 1.857 -11.455 4.169 -22.306 -1.686 C 33.143 108.747 28.866 101.635 25.43 95.921 23.552 92.799 21.93 90.102 19.665 88.085 13.985 83.027 8.25 73.653 8.25 64.119 c 0 -15.648 1.5 -32.624 19.414 -35.99 20.31 -3.816 27.261 -8.578 34.619 -13.618 l 0.562 -0.385 c 1.312 -0.9 2.657 -1.817 4.087 -2.655 2.677 6.442 9.237 11.688 17.315 13.651 2.206 0.536 4.467 0.808 6.737 0.81 4.723 0.077 9.364 -1.245 13.337 -3.8 2.139 3 4.14 7.176 6.175 13.7 1.581 5.09 3.54 10.055 5.86 14.853 2.117 4.524 3.394 7.255 3.394 12.272 0 8.688 -4.35 20.694 -11.623 25.743 z"/>
                    <Path Fill="Black" Data="m 93.9 47.66 c 1.379 -5.677 -3.2 -11.681 -10.21 -13.383 -7.01 -1.702 -13.832 1.535 -15.211 7.212 -1.379 5.677 3.2 11.681 10.211 13.383 1.24 0.302 2.512 0.456 3.788 0.459 1.977 0.014 3.935 -0.393 5.743 -1.193 2.804 -1.149 4.907 -3.547 5.679 -6.478 z m -14.388 3.81 c -5.134 -1.246 -8.56 -5.354 -7.637 -9.155 0.742 -3.055 4.068 -5 8.009 -5 1.002 0.002 2.001 0.123 2.975 0.361 5.134 1.247 8.56 5.354 7.637 9.157 -0.53 1.877 -1.907 3.399 -3.722 4.114 -2.296 0.973 -4.85 1.157 -7.262 0.523 z"/>
                    <Path Fill="Black" Data="m 95.771 70.312 c -2.401 0.338 -4.623 1.463 -6.315 3.2 -3.8 3.8 -4.357 9.428 -1.24 12.545 1.373 1.335 3.225 2.062 5.14 2.018 2.8 -0.072 5.46 -1.242 7.405 -3.258 3.8 -3.8 4.356 -9.428 1.239 -12.545 -1.653 -1.595 -3.96 -2.321 -6.229 -1.96 z m 2.515 12.035 c -2.4 2.4 -5.874 2.961 -7.6 1.24 -1.726 -1.721 -1.154 -5.2 1.241 -7.6 1.142 -1.186 2.644 -1.961 4.273 -2.202 0.218 -0.027 0.437 -0.04 0.656 -0.041 0.989 -0.037 1.952 0.327 2.67 1.008 1.722 1.722 1.155 5.201 -1.24 7.595 z"/>
                    <Path Fill="Black" Data="m 41.562 85.722 c -3.088 -1.541 -6.841 -0.287 -8.382 2.801 -0.22 0.44 -0.386 0.904 -0.497 1.383 -0.478 1.897 -0.273 3.902 0.58 5.662 1.201 2.748 3.866 4.568 6.862 4.689 0.895 0.002 1.78 -0.194 2.59 -0.575 3.39 -1.6 4.666 -6.043 2.845 -9.908 -0.816 -1.778 -2.231 -3.213 -3.998 -4.052 z m -0.339 10.794 c -1.642 0.776 -3.8 -0.32 -4.794 -2.44 -0.501 -1.015 -0.63 -2.173 -0.363 -3.273 0.19 -0.855 0.753 -1.58 1.534 -1.976 0.35 -0.164 0.731 -0.247 1.117 -0.245 0.479 0.006 0.95 0.115 1.383 0.32 1.018 0.495 1.83 1.331 2.294 2.364 0.999 2.119 0.473 4.475 -1.171 5.25 z"/>
                    <Path Fill="Black" Data="m 59.058 66.137 c -4.1 1.933 -6.13 5.962 -4.617 9.172 1.125 2.132 3.394 3.407 5.8 3.261 1.458 -0.015 2.895 -0.35 4.209 -0.983 4.1 -1.933 6.129 -5.962 4.616 -9.172 -1.513 -3.21 -5.908 -4.215 -10.008 -2.278 z m 3.9 8.284 c -2.445 1.151 -4.784 0.606 -5.355 -0.6 -0.571 -1.206 0.5 -3.362 2.943 -4.514 0.835 -0.405 1.748 -0.622 2.676 -0.634 1.053 -0.118 2.084 0.357 2.678 1.234 0.575 1.21 -0.494 3.362 -2.938 4.514 z"/>
                    <Path Fill="Black" Data="m 39.67 35.374 c 0.118 0.006 0.248 0.008 0.392 0.008 3.234 0 12.734 -1.389 16.02 -5.246 0.63 -0.733 0.546 -1.838 -0.187 -2.468 -0.733 -0.63 -1.838 -0.546 -2.468 0.187 -0.003 0.004 -0.006 0.007 -0.009 0.011 -2.284 2.681 -10.773 4.125 -13.588 4.012 -0.966 -0.044 -1.786 0.704 -1.83 1.67 -0.044 0.966 0.703 1.786 1.67 1.83 z"/>
                    <Path Fill="Black" Data="m 21.226 69.766 c -1.874 -1.518 -2.6 -7.151 -2.36 -9.591 0.115 -0.96 -0.57 -1.831 -1.53 -1.945 -0.96 -0.115 -1.831 0.57 -1.945 1.53 -0.003 0.022 -0.005 0.045 -0.007 0.067 -0.24 2.4 0.177 9.856 3.64 12.659 0.77 0.584 1.868 0.434 2.452 -0.336 0.559 -0.737 0.449 -1.781 -0.252 -2.384 z"/>
                    <Path Fill="Black" Data="m 107.2 50.537 c -0.901 0.349 -1.349 1.362 -1.001 2.264 0 0 0 10e-4 0.001 10e-4 1.384 4.086 2.022 8.388 1.882 12.7 -0.031 0.966 0.725 1.774 1.691 1.807 h 0.059 c 0.944 -10e-4 1.717 -0.75 1.748 -1.693 0.16 -4.786 -0.558 -9.561 -2.118 -14.088 -0.352 -0.897 -1.364 -1.34 -2.262 -0.991 z"/>
                    <Path Fill="Black" Data="m 88.555 94.6 c -4.071 4.208 -4.918 13.148 -4.952 13.527 -0.087 0.962 0.622 1.813 1.584 1.9 0.054 0 0.108 0.007 0.161 0.007 0.904 -0.001 1.658 -0.691 1.741 -1.591 0.2 -2.24 1.318 -8.655 3.981 -11.409 0.676 -0.691 0.665 -1.798 -0.026 -2.475 -0.691 -0.677 -1.798 -0.665 -2.475 0.026 -0.004 0.005 -0.009 0.01 -0.014 0.015 z"/>
                    <Path Fill="Black" Data="m 51.163 55.65 c -3.909 -0.663 -11.338 4.082 -13.076 9.367 -0.301 0.917 0.196 1.905 1.113 2.209 0.176 0.058 0.36 0.088 0.546 0.088 0.755 0 1.425 -0.483 1.663 -1.2 1.3 -3.946 7.176 -7.348 9.174 -7.008 0.951 0.171 1.861 -0.462 2.032 -1.413 0.171 -0.951 -0.462 -1.861 -1.413 -2.032 -0.014 -0.003 -0.029 -0.005 -0.043 -0.007 z"/>
                </Canvas>
            </Viewbox>

            <Viewbox x:Key="Asteroid2">
                <Canvas Width="300" Height="284.54434">
                    <Path Stretch="Uniform" Fill="Black" Data="M126.5,284.2965C118.6683,283.51314 107.42141,280.67328 102.31347,278.18936 95.49957,274.87586 88.4845,267.89793 78.42724,254.42959 73.90951,248.37959 67.88684,240.72959 65.04354,237.42959 57.54413,228.72559 52.66869,220.99784 46.09612,207.39722 39.56791,193.8884 38.23211,192.33161 23.19958,180.7127 4.33827,166.13448 0,160.49875 0,150.57476 0,141.8518 3.33233,133.25334 12.71329,117.77054 17.4923,109.88302 23.93601,97.804594 27.03264,90.929594 40.11278,61.889695 53.09095,44.128765 62.52377,42.359155 65.96053,41.714415 72.25256,41.914615 100.17525,43.557145 109.9232,44.130555 111.14774,44.001405 114.2723,42.070325 116.15429,40.907185 119.67542,37.188005 122.09705,33.805475 141.07801,7.2928054 145.76152,2.4777054 154.14387,0.858275400000004 160.34428,-0.339604599999996 194.95963,-0.265464599999996 205.02623,0.967275400000004 214.87412,2.1732154 224.59024,6.3159454 232.70991,12.770935 239.95029,18.526905 275.62594,57.342795 284.63245,69.263804 288.7189,74.67262 293.84833,82.650131 296.03118,86.991607 299.71266,94.313714 300,95.491964 300,103.26606 300,110.78399 299.42082,113.3815 294.375,128.49324 287.3646,149.4887 287.30865,151.50352 293.11338,173.92959 298.36735,194.22781 298.71954,201.7916 294.76845,209.47469 291.1175,216.57415 284.57145,223.50301 274.94743,230.45482 270.39815,233.74094 262.38344,239.75192 257.13694,243.81255 242.9957,254.75745 239.86371,256.39942 221.76174,262.3582 212.6611,265.35394 200.22021,270.31005 194.11532,273.37177 188.01042,276.43349 179.52452,280.14474 175.25776,281.619 168.05032,284.10932 166.18765,284.31355 149,284.49803 138.825,284.60725 128.7,284.51653 126.5,284.2965z M172,272.16891C175.025,271.07632 182.9,267.62701 189.5,264.50376 196.1,261.38052 209.15,256.14262 218.5,252.86399 236.77333,246.45635 236.33711,246.70911 259.7187,228.97979 284.70498,210.0337 287.6316,206.29096 286.70513,194.46789 286.40178,190.59682 284.4634,180.90459 282.39761,172.92959 276.78969,151.28019 277.00364,146.2776 284.47193,124.42959 291.35566,104.29166 291.74939,100.12691 287.54444,91.929594 281.42005,79.990408 273.32916,69.83502 248.17165,42.510295 231.46484,24.364255 225.68411,19.096015 218.06174,15.069775 208.88084,10.220305 202.97815,9.41015540000001 178.23999,9.60422540000001 149.97383,9.82597540000001 151.25745,9.15821540000001 136.28546,31.429595 129.67835,41.257915 122.39279,49.157995 117.6964,51.586595 113.11899,53.953665 100.9705,54.332785 87.32994,52.534245 72.37358,50.562215 67.90041,50.526535 63.54923,52.344575 57.06633,55.053305 45.98355,71.779132 36.12707,93.729344 32.94776,100.80961 27.36848,111.73864 23.72867,118.01607 14.55644,133.83505 10.9605,141.91216 10.31781,148.13923 9.80949999999996,153.06428 10.02679,153.81011 13.17587,157.94955 15.05037,160.41357 22.0575,166.70459 28.74727,171.92959 46.88009,186.09211 47.3256,186.61572 55.54893,203.42959 61.0465,214.67022 64.6495,220.5599 69.92502,226.92959 73.79696,231.60459 81.4147,241.30319 86.85333,248.48204 92.29196,255.66089 98.20994,262.7699 100.0044,264.27984 109.82134,272.54026 122.08065,275.01283 150.5,274.46426 163.39687,274.21532 167.5667,273.77015 172,272.16891z M153.74797,246.50284C148.42316,244.6026 143.55174,240.61206 141.64073,236.58491 139.62572,232.33858 139.508,223.7694 141.41468,220.12993 143.50188,216.14588 148.9635,211.25474 153.38391,209.4109 158.41614,207.31186 169.6155,207.32439 174.66741,209.4347 184.90566,213.71149 190.49525,225.18094 186.93867,234.61448 185.42945,238.61755 180.17617,243.86007 175.5,246.02973 170.69472,248.25929 159.36067,248.5058 153.74797,246.50283z M172.82449,235.22207C174.29602,234.12933 176.175,232.04149 177,230.58243 178.33333,228.22435 178.33333,227.63483 177,225.27675 170.77199,214.26213 150,216.73665 150,228.4932 150,231.47026 154.75751,236.51495 158.28641,237.2798 162.75777,238.24892 170.15913,237.2013 172.82449,235.22207z M55.83835,169.79101C50.26635,168.24143 44.12557,162.37442 40.86753,155.4876 35.56499,144.27917 37.3912,127.96785 44.97848,118.76938 54.34381,107.4153 71.41567,108.78333 79.88281,121.56639 83.98438,127.75863 85.39976,132.85358 85.40082,141.42959 85.40182,152.78511 79.51067,163.53509 70.84176,167.99468 66.15927,170.40352 60.48411,171.083 55.83835,169.79101z M69.25493,156.608C76.81114,149.05178 77.02405,133.25658 69.67692,125.3005 65.40893,120.67876 60.74995,119.93131 56,123.10627 46.21915,129.64397 45.14589,147.31077 53.99216,156.15704 57.124,159.28888 58.45836,159.92959 61.84902,159.92959 65.14169,159.92959 66.57714,159.28578 69.25493,156.608z M201.92935,144.61956C191.09181,141.56149 180.78357,132.2783 176.95783,122.13122 175.19505,117.45578 174.88435,114.89974 175.23155,107.92959 175.78316,96.855504 178.44701,90.688461 185.60165,83.921906 200.92047,69.434 222.38601,69.944053 236.59402,85.13356 243.55136,92.571524 246.44134,99.692474 246.45437,109.42959 246.46337,116.32574 246.03266,118.34734 243.33128,124.08084 241.6077,127.73903 238.30862,132.62097 236,134.92959 227.58721,143.34238 212.55468,147.61776 201.92935,144.61956z M221.67531,132.5975C230.87199,127.84171 235.98883,119.54766 235.96827,109.42959 235.92907,90.132096 215.86806,77.848953 198.88247,86.722332 174.23224,99.599764 184.72547,136.35434 212.54519,134.57864 215.87004,134.36641 219.97859,133.4749 221.67531,132.5975z M105.68498,119.96401C98.05687,117.5354 93,110.74463 93,102.92959 93,92.458844 100.78229,84.929594 111.60494,84.929594 125.43304,84.929594 133.88971,98.263084 127.90395,110.628 124.40041,117.86535 113.49103,122.44928 105.68498,119.96401z M115.92859,108.96781C116.917,108.43883 118.29091,106.64148 118.98173,104.97371 120.04926,102.39645 119.98687,101.5585 118.56599,99.389954 115.27629,94.369254 109.20168,93.727914 104.97456,97.955034 99.02651,103.90308 108.18588,113.11158 115.92859,108.96781z"/>
                </Canvas>
            </Viewbox>
        </ItemsControl.Resources>
        
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <StackPanel HorizontalAlignment="Right">
                        <TextBlock Text="{Binding ActualWidth, ElementName=asteroidFieldRoot}"/>
                        <TextBlock Text="{Binding ActualHeight, ElementName=asteroidFieldRoot}"/>
                    </StackPanel>
                    <!--<Viewbox>-->
                        <Canvas Width="{Binding ActualWidth, ElementName=asteroidFieldRoot, Mode=OneWay}" Height="{Binding ActualHeight, ElementName=asteroidFieldRoot, Mode=OneWay}" VerticalAlignment="Top" HorizontalAlignment="Left" Panel.ZIndex="1">
                        <!--<Canvas Width="509" Height="312">-->
                            <Path Stroke="Black" >
                                <Path.Data>
                                    <PathGeometry x:Name="trajectoryPath">
                                        <PathGeometry.Figures>
                                            <PathFigureCollection>
                                                <PathFigure StartPoint="5,250">
                                                    <!--<PathFigure.StartPoint>
                                                        <MultiBinding Converter="{StaticResource PointPercentageToPixelConverter}" Mode="OneWay">
                                                            <Binding Path="TrajectoryStartPoint" Mode="OneWay"/>
                                                            <Binding Path="ActualWidth" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                            <Binding Path="ActualHeight" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                        </MultiBinding>
                                                    </PathFigure.StartPoint>-->

                                                    <PathFigure.Segments>
                                                        <PathSegmentCollection>
                                                            <!--<QuadraticBezierSegment Point1="262,175" Point2="504,307">-->
                                                            <QuadraticBezierSegment>
                                                                <QuadraticBezierSegment.Point1>
                                                                    <MultiBinding Converter="{StaticResource PointPercentageToPixelConverter}" Mode="OneWay">
                                                                        <Binding Path="TrajectoryControlPoint" Mode="OneWay"/>
                                                                        <Binding Path="ActualWidth" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                                        <Binding Path="ActualHeight" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                                    </MultiBinding>
                                                                </QuadraticBezierSegment.Point1>

                                                                <QuadraticBezierSegment.Point2>
                                                                    <MultiBinding Converter="{StaticResource PointPercentageToPixelConverter}" Mode="OneWay">
                                                                        <Binding Path="TrajectoryEndPoint" Mode="OneWay"/>
                                                                        <Binding Path="ActualWidth" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                                        <Binding Path="ActualHeight" ElementName="asteroidFieldRoot" Mode="OneWay"/>
                                                                    </MultiBinding>
                                                                </QuadraticBezierSegment.Point2>
                                                            </QuadraticBezierSegment>
                                                        </PathSegmentCollection>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathFigureCollection>
                                        </PathGeometry.Figures>
                                    </PathGeometry>
                                </Path.Data>
                            </Path>
                        </Canvas>
                    <!--</Viewbox>-->

                    <Canvas Margin="-50,-50,0,0" x:Name="asteroidCanvas" Width="100" Height="100" VerticalAlignment="Top" HorizontalAlignment="Left" RenderTransformOrigin="0.5,0.5">
                        <Canvas.RenderTransform>
                            <TransformGroup>
                                <RotateTransform x:Name="asteroidAngle"/>
                                <MatrixTransform x:Name="asteroidTransformMatrix"/>
                            </TransformGroup>
                        </Canvas.RenderTransform>

                        <Canvas.Triggers>
                            <EventTrigger RoutedEvent="Canvas.Loaded">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="asteroidAngle" Storyboard.TargetProperty="Angle" From="0" To="{Binding RotationTo, Mode=OneWay}" Duration="{Binding OneRevolutionDurantion, Mode=OneWay}" RepeatBehavior="Forever"/>

                                        
                                        <MatrixAnimationUsingPath Storyboard.TargetName="asteroidTransformMatrix" Storyboard.TargetProperty="Matrix" Duration="{Binding TrajectoryDurantion}" PathGeometry="{Binding ElementName=trajectoryPath}"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Canvas.Triggers>

                        <ContentPresenter Width="{Binding ElementName=asteroidCanvas, Mode=OneWay, Path=ActualWidth}" Height="{Binding ElementName=asteroidCanvas, Mode=OneWay, Path=ActualHeight}" Content="{StaticResource Asteroid1}"/>
                    </Canvas>
                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</UserControl>
